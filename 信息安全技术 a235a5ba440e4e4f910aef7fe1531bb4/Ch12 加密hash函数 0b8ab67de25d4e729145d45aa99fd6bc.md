# Ch12 åŠ å¯†hashå‡½æ•°

# å¼•è¨€

## è¿­ä»£hashå‡½æ•°

Merkle-Damgardæ–¹æ¡ˆæ˜¯æŠ—å†²çªçš„è¿­ä»£hashå‡½æ•°ã€‚

![Untitled](Ch12%20%E5%8A%A0%E5%AF%86hash%E5%87%BD%E6%95%B0%200b8ab67de25d4e729145d45aa99fd6bc/Untitled.png)

## å‹ç¼©å‡½æ•°çš„è®¾è®¡

å‹ç¼©å‡½æ•°çš„è®¾è®¡åŒ…å«ä¸¤ç§ï¼š

- ä»å¤´å¼€å§‹åˆ›å»ºæ–°çš„å‹ç¼©å‡½æ•°ï¼šMDã€SHA
- ä½¿ç”¨å¯¹ç§°å¯†é’¥åˆ†ç»„å¯†ç ä½œä¸ºå‹ç¼©å‡½æ•°ï¼šWhirlpool

# SHA-512

## æ•´ä½“æ¶æ„

![Untitled](Ch12%20%E5%8A%A0%E5%AF%86hash%E5%87%BD%E6%95%B0%200b8ab67de25d4e729145d45aa99fd6bc/Untitled%201.png)

1. æ¶ˆæ¯å‡†å¤‡ï¼šæ¶ˆæ¯çš„é•¿åº¦è¦å°äº$2^{128}$ï¼Œä¸€èˆ¬ä¸éœ€è¦è€ƒè™‘é•¿åº¦çš„é™åˆ¶ï¼Œè¿™ä¸æ˜¯ä¸€ä¸ªä¸¥é‡çš„é—®é¢˜ã€‚
2. é•¿åº¦åŸŸä¸ä¿¡æ¯å¡«å……ï¼šå¯¹æ¶ˆæ¯æ·»åŠ é™„åŠ ææ–™ä»¥åŠé•¿åº¦åŸŸï¼ˆ128bitï¼‰ä½¿ä¿¡æ¯çš„é•¿åº¦è¾¾åˆ°1024çš„æ•´æ•°å€ã€‚
    
    <aside>
    ğŸ”¥ The computation of length field and padding.
    
    </aside>
    
    ![Untitled](Ch12%20%E5%8A%A0%E5%AF%86hash%E5%87%BD%E6%95%B0%200b8ab67de25d4e729145d45aa99fd6bc/Untitled%202.png)
    
    $(|M|+|P|+128) = 0 \mod 1024 \Rightarrow |P| = (-|M|-128) \mod 1024$
    
    - å¡«å……çš„æ ¼å¼æ˜¯1åé¢è·Ÿå¿…è¦ä¸ªæ•°çš„0ã€‚
    - å¦‚æœåŸå§‹ä¿¡æ¯é•¿åº¦ä¸º1024çš„å€æ•°ä¾ç„¶è¦å¡«å……ã€‚
    - **å¡«å……æ¯”ç‰¹çš„æœ€é•¿ä¸ªæ•°ä¸º1023ï¼ˆæ¶ˆæ¯çš„æœ€åä¸€ä¸ªåˆ†ç»„æœ‰897ä½ï¼‰ï¼Œæœ€å°‘ä¸º0ï¼ˆæ¶ˆæ¯çš„æœ€åä¸€ä¸ªåˆ†ç»„æœ‰896ä½ï¼‰**ã€‚
    
    > What is the number of padding bits if the length of the original
    message is 2590 bits?
    $|P| = (-2590-128) \mod 1024 = 354$
    > 
3. å­—ï¼šSHA-512æ˜¯é¢å‘å­—çš„ï¼Œæ¯ä¸€ä¸ªå­—64bitï¼Œä¸€ä¸ªæ¶ˆæ¯åˆ†ç»„ç§åŒ…å«16ä¸ªå­—ï¼Œæ‘˜è¦ç§åªæœ‰8ä¸ªå­—ï¼Œå‘½åA-Hã€‚
    
    ![Untitled](Ch12%20%E5%8A%A0%E5%AF%86hash%E5%87%BD%E6%95%B0%200b8ab67de25d4e729145d45aa99fd6bc/Untitled%203.png)
    
4. å­—æ‹“å±•ï¼šå°†16ä¸ªå­—æ‹“å±•ä¸º80ä¸ªå­—ã€‚
    
    ![Untitled](Ch12%20%E5%8A%A0%E5%AF%86hash%E5%87%BD%E6%95%B0%200b8ab67de25d4e729145d45aa99fd6bc/Untitled%204.png)
    
5. åˆå§‹åŒ–æ¶ˆæ¯æ‘˜è¦ï¼šå‰å…«ä¸ªç´ æ•°å¹³æ–¹æ ¹åè½¬åŒ–ä¸ºäºŒè¿›åˆ¶çš„å°æ•°éƒ¨åˆ†ã€‚
    
    ![Untitled](Ch12%20%E5%8A%A0%E5%AF%86hash%E5%87%BD%E6%95%B0%200b8ab67de25d4e729145d45aa99fd6bc/Untitled%205.png)
    

## å‹ç¼©å‡½æ•°

### æ€»ä½“ç»“æ„

ä¸€å…±åŒ…å«80ä¸ªè½®ï¼Œç¬¬$i$è½®çš„è¾“å…¥æœ‰ä¸‰ä¸ªéƒ¨åˆ†ï¼š

- å­—$W_i$ï¼ˆ64bit)ï¼›
- å¸¸æ•°$K_i$ï¼ˆ64bitï¼‰ï¼šå‰80ä¸ªç´ æ•°æ±‚ç«‹æ–¹æ ¹è½¬åŒ–ä¸ºäºŒè¿›åˆ¶çš„å°æ•°éƒ¨åˆ†ï¼›
- å‰ä¸€ç»„çš„æ‘˜è¦ç¼“å†²$H_{i-1}$ï¼ˆ512bitï¼Œå«æœ‰8ä¸ª64bitçš„å­—ï¼‰ã€‚

![Untitled](Ch12%20%E5%8A%A0%E5%AF%86hash%E5%87%BD%E6%95%B0%200b8ab67de25d4e729145d45aa99fd6bc/Untitled%206.png)

### æ¯ä¸€è½®ç»“æ„

<aside>
ğŸ”¥ The computation of Majority function and Conditional function.

</aside>

![Untitled](Ch12%20%E5%8A%A0%E5%AF%86hash%E5%87%BD%E6%95%B0%200b8ab67de25d4e729145d45aa99fd6bc/Untitled%207.png)

1. 6ä¸ªè¾“å‡ºçš„å­—æ˜¯è¾“å…¥å­—çš„å‰¯æœ¬ï¼šBã€Cã€Dã€Fã€Gã€Hã€‚
2. Majority Functionï¼šå¾—åˆ°çš„æ¯ä¸€ä¸ªæ¯”ç‰¹æ˜¯ä¸‰ä¸ªè¾“å…¥å¯¹åº”æ¯”ç‰¹çš„å¤§å¤šæ•°ã€‚æœ‰2ä¸ªæˆ–å¤šä¸ªè¾“å…¥æ¯”ç‰¹æ˜¯0ï¼Œè¾“å‡ºå°±æ˜¯0ï¼Œå¦åˆ™è¾“å‡º1ã€‚
    
    > 1.We apply the **Majority function** on buffers A, B, and C. If the
    leftmost hexadecimal digits of these buffers are 0x7, 0xA, and 0xE,
    respectively, what is the leftmost digit of the result?
    $0x7=(0111)_2$ã€$0xA=(1010)_2$ã€$0xE=(1110)_2$
    $result = (1110)_2=0xE$
    
    2.Find the result of Majority (x, y, z) if
    x = 1234 5678 ABCD 2345 3456 5678 ABCD 2468
    y = 2234 5678 ABCD 2345 3456 5678 ABCD 2468
    x = 3234 5678 ABCD 2345 3456 5678 ABCD 2468
    > 
3. Conditional Functionï¼šå¦‚æœEçš„å¯¹åº”æ¯”ç‰¹ä¸º1ï¼Œè¾“å‡ºFå¯¹åº”æ¯”ç‰¹ï¼Œå¦åˆ™è¾“å‡ºGå¯¹åº”æ¯”ç‰¹ã€‚
    
    > 1.We apply the Conditional function on E, F, and G buffers. If the
    leftmost hexadecimal digits of these buffers are 0x9, 0xA, and 0xF respectively, what is the leftmost digit of the result?
    $0x9=(1001)_2$ã€$0xA=(1010)_2$ã€$0xE=(1111)_2$
    $result = (1110)_2=0xE$
    
    2.Find the result of Conditional (x, y, z) if
    x = 1234 5678 ABCD 2345 3456 5678 ABCD 2468
    y = 2234 5678 ABCD 2345 3456 5678 ABCD 2468
    x = 3234 5678 ABCD 2345 3456 5678 ABCD 2468
    > 
4. RotR(Â·)æ˜¯å¾ªç¯å³ç§»ã€‚
5. åŠ æ³•è¿ç®—æ˜¯æ¨¡$2^{64}$è¿ç®—ï¼Œä¿è¯è¾“å‡ºæ˜¯64æ¯”ç‰¹ã€‚